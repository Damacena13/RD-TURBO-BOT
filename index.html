<script>
    function login() {
        const e = document.getElementById('email').value;
        const p = document.getElementById('pass').value;
        firebase.auth().signInWithEmailAndPassword(e, p)
            .then((user) => {
                // VERIFICA SE O ADMINISTRADOR LIBEROU O ACESSO NO FIRESTORE
                db.collection('usuarios').doc(user.user.uid).get().then(doc => {
                    if (doc.exists && doc.data().status === 'liberado') {
                        alert("Acesso Liberado! Entrando...");
                        // Redireciona para o robô
                    } else {
                        alert("Seu acesso está PENDENTE. Fale com o suporte para liberar sua assinatura.");
                        firebase.auth().signOut();
                    }
                });
            })
            .catch(err => alert("Erro: Login inválido."));
    }

    function cadastrar() {
        const e = document.getElementById('email').value;
        const p = document.getElementById('pass').value;
        firebase.auth().createUserWithEmailAndPassword(e, p)
            .then((user) => {
                // CRIA O USUÁRIO COMO 'PENDENTE' PARA VOCÊ LIBERAR DEPOIS
                db.collection('usuarios').doc(user.user.uid).set({
                    email: e,
                    status: 'pendente',
                    data: new Date()
                });
                alert("CADASTRO REALIZADO! Chame no WhatsApp para ativar sua assinatura.");
            })
            .catch(err => alert("Erro ao criar conta."));
    }
</script>
